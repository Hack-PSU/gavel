{% extends "layout.html" %}
{% block title %}Admin{% endblock %}
{% block head %}
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
.graph-container {
  width: 100%;
  height: 600px;
  border: 1px solid #e4e4e4;
  border-radius: 4px;
  background: #ffffff;
  position: relative;
  overflow: hidden;
}
.graph-tooltip {
  position: absolute;
  padding: 8px 12px;
  background: rgba(0, 0, 0, 0.85);
  color: white;
  border-radius: 4px;
  font-size: 12px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
  z-index: 1000;
}
.node {
  cursor: pointer;
  stroke: #173753;
  stroke-width: 1.5px;
}
.link {
  stroke: #999;
  stroke-opacity: 0.6;
}

/* Table overflow handling */
.info {
  overflow-x: auto;
  width: 100%;
}

table {
  min-width: 100%;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
  .graph-container {
    height: 400px;
  }

  table {
    font-size: 14px;
  }

  td, th {
    padding: 0.5rem;
  }
}
</style>
{% endblock %}
{% block content %}
<div class="item">
  <div class="banner" id="admin-header">
    <h1>Admin</h1>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Statistical Summary</h2>
  </div>
  <div class="info">
    <p><strong>Total Comparisons:</strong> {{ statistical_summary.total_comparisons }}</p>
    <p><strong>Active Judges:</strong> {{ statistical_summary.active_judges }} of {{ statistical_summary.total_judges }} total</p>
    <p><strong>Avg Comparisons/Project:</strong> {{ statistical_summary.avg_comparisons_per_project }}</p>
    <p><strong>Completion:</strong> {{ statistical_summary.completion_percentage }}%</p>
    <p><strong>Convergence Status:</strong> {{ statistical_summary.convergence_status }} (Avg σ²: {{ statistical_summary.avg_uncertainty }})</p>
    <p><strong>Estimated Votes Needed:</strong> {{ statistical_summary.estimated_votes_needed }} to converge</p>
    {% if statistical_summary.high_uncertainty_projects %}
    <p><strong>⚠️ High Uncertainty Projects:</strong></p>
    <ul>
      {% for project_name, sigma_sq in statistical_summary.high_uncertainty_projects %}
      <li>{{ project_name }} (σ²: {{ sigma_sq | round(3) }})</li>
      {% endfor %}
    </ul>
    {% endif %}
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Voting Activity (Last 2 Hours)</h2>
  </div>
  <div class="info">
    <p><strong>Last Hour:</strong> {{ voting_timeline.votes_last_hour }} votes | <strong>Peak Hour:</strong> {{ voting_timeline.peak_hour or 'N/A' }} | <strong>Avg/Hour:</strong> {{ voting_timeline.avg_votes_per_hour | round(1) }}</p>
    <canvas id="votingTimelineChart" style="max-height: 300px;"></canvas>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>All Decisions ({{ all_decisions | length }} total)</h2>
  </div>
  <div class="info">
    <details open>
      <summary style="cursor: pointer; font-weight: bold; margin-bottom: 10px;">View All Decisions</summary>
      <div style="overflow-x: auto; margin-top: 10px;">
        <table id="decisions" style="width: 100%; font-size: 13px;">
          <thead>
            <tr>
              <th data-sort-method="number">ID</th>
              <th data-sort-method="caseInsensitiveSort">Judge</th>
              <th data-sort-method="caseInsensitiveSort">Winner</th>
              <th data-sort-method="caseInsensitiveSort">Loser</th>
              <th data-sort-method="caseInsensitiveSort" class="sort-default" data-sort-order="desc">Time</th>
              <th data-sort-method="caseInsensitiveSort">Notes</th>
            </tr>
          </thead>
          <tbody>
            {% for decision in all_decisions %}
            <tr>
              <td>{{ decision.id }}</td>
              <td><a href="{{ url_for('annotator_detail', annotator_id=decision.annotator.id) }}">{{ decision.annotator.name }}</a></td>
              <td><a href="{{ url_for('item_detail', item_id=decision.winner.id) }}" style="color: #28a745; font-weight: bold;">{{ decision.winner.name }}</a></td>
              <td><a href="{{ url_for('item_detail', item_id=decision.loser.id) }}" style="color: #dc3545;">{{ decision.loser.name }}</a></td>
              <td>{{ decision.time.strftime('%Y-%m-%d %H:%M:%S') }}</td>
              <td>{% if decision.notes %}{{ decision.notes }}{% endif %}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </details>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Project Coverage Heatmap</h2>
  </div>
  <div class="info">
    <p><strong>Coverage:</strong> {{ coverage_matrix.coverage_percentage | round(1) }}% of possible pairs compared</p>
    <p><strong>Avg Comparisons per Pair:</strong> {{ coverage_matrix.avg_comparisons_per_pair | round(1) }}</p>
    {% if coverage_matrix.under_compared_pairs %}
    <details>
      <summary style="cursor: pointer; font-weight: bold; color: #dc3545;">Under-Compared Project Pairs</summary>
      <ul style="margin-top: 10px;">
        {% for pair in coverage_matrix.under_compared_pairs %}
        <li>{{ pair.project_a }} ↔ {{ pair.project_b }} ({{ pair.comparisons }} comparisons)</li>
        {% endfor %}
      </ul>
    </details>
    {% endif %}
    <div style="overflow-x: auto; margin-top: 15px;">
      <canvas id="coverageHeatmap"></canvas>
    </div>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Projects</h2>
  </div>
  <div class="info">
    <table id="items">
      <thead>
        <tr>
          <th data-sort-method="number">Id</th>
          <th data-sort-method="caseInsensitiveSort">Name</th>
          <th data-sort-method="caseInsensitiveSort">Location</th>
          <th data-sort-method="caseInsensitiveSort">Description</th>
          <th class="sort-default" data-sort-method="number" data-sort-order="desc">Mu</th>
          <th data-sort-method="number">Sigma Squared</th>
          <th data-sort-method="number">Votes</th>
          <th data-sort-method="number">Seen</th>
          <th data-sort-method="number" data-sort-order="desc">Skipped</th>
          <th data-sort-method="caseInsensitiveSort" data-sort-order="desc">Prioritize</th>
          <th data-sort-method="caseInsensitiveSort">Active</th>
          <th class="no-sort">Delete</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
        <tr class="{{ 'disabled' if not item.active else 'prioritized' if item.prioritized else '' }}">
          <td><a href="{{ url_for('item_detail', item_id=item.id) }}" class="colored">{{ item.id }}</a></td>
          <td>{{ item.name }}</td>
          <td>{{ item.location }}</td>
          <td class="preserve-formatting">{{ item.description }}</td>
          <td>{{ item.mu | round(4) }}</td>
          <td>{{ item.sigma_sq | round(4) }}</td>
          <td>{{ item_counts.get(item.id, 0) }}</td>
          <td>{{ item.viewed | length }}</td>
          <td>{{ skipped.get(item.id, 0) }}</td>
          <td class="compact" data-sort="{{ item.prioritized }}">
            <form action="{{ url_for('item') }}" method="post">
              <input type="submit" name="action" value="{{ 'Prioritize' if not item.prioritized else 'Cancel' }}" class="{{ 'positive' if not item.prioritized else 'negative' }}">
              <input type="hidden" name="item_id" value="{{ item.id }}">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
            </form>
          </td>
          <td class="compact" data-sort="{{ item.active }}">
            <form action="{{ url_for('item') }}" method="post">
              <input type="submit" name="action" value="{{ 'Disable' if item.active else 'Enable' }}" class="{{ 'negative' if item.active else 'positive' }}">
              <input type="hidden" name="item_id" value="{{ item.id }}">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
            </form>
          </td>
          <td class="compact">
            <form action="{{ url_for('item') }}" method="post">
              <input type="submit" name="action" value="Delete" class="negative">
              <input type="hidden" name="item_id" value="{{ item.id }}">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="api-link">
    <a href="{{ url_for('item_dump') }}">Download CSV</a>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Judges</h2>
  </div>
  <div class="info">
    <table id="annotators">
      <thead>
        <tr>
          <th class="sort-default" data-sort-method="number">Id</th>
          <th data-sort-method="caseInsensitiveSort">Name</th>
          <th data-sort-method="caseInsensitiveSort">Email</th>
          <th data-sort-method="caseInsensitiveSort">Description</th>
          <th data-sort-method="number">Votes</th>
          <th data-sort-method="number">Alpha</th>
          <th data-sort-method="number">Beta</th>
          <th data-sort-method="number">Next (Id)</th>
          <th data-sort-method="number">Previous (Id)</th>
          <th data-sort-method="number" data-sort-order="desc">Updated</th>
          <th class="no-sort">Email</th>
          <th data-sort-method="caseInsensitiveSort">Active</th>
          <th class="no-sort">Delete</th>
        </tr>
      </thead>
      <tbody>
        {% for annotator in annotators %}
        <tr class="{{ 'disabled' if not annotator.active else '' }}">
          <td><a href="{{ url_for('annotator_detail', annotator_id=annotator.id) }}" class="colored">{{ annotator.id }}</a></td>
          <td>{{ annotator.name }}</td>
          <td>{{ annotator.email }}</td>
          <td>{{ annotator.description }}</td>
          <td>{{ counts.get(annotator.id, 0) }}</td>
          <td>{{ annotator.alpha | round(4) }}</td>
          <td>{{ annotator.beta | round(4) }}</td>
          <td data-sort="{{ annotator.next_id or -1 }}">{{ annotator.next_id }}</td>
          <td data-sort="{{ annotator.prev_id or -1 }}">{{ annotator.prev_id }}</td>
          <td data-sort="{{ annotator.updated | utcdatetime_epoch }}">{{ annotator.updated | utcdatetime_local }}</td>
          <td class="compact">
            <form action="{{ url_for('annotator') }}" method="post">
              <input type="submit" name="action" value="Email" class="neutral">
              <input type="hidden" name="annotator_id" value="{{ annotator.id }}">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
            </form>
          </td>
          <td class="compact" data-sort="{{ annotator.active }}">
            <form action="{{ url_for('annotator') }}" method="post">
              <input type="submit" name="action" value="{{ 'Disable' if annotator.active else 'Enable' }}" class="{{ 'negative' if annotator.active else 'positive' }}">
              <input type="hidden" name="annotator_id" value="{{ annotator.id }}">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
            </form>
          </td>
          <td class="compact">
            <form action="{{ url_for('annotator') }}" method="post">
              <input type="submit" name="action" value="Delete" class="negative">
              <input type="hidden" name="annotator_id" value="{{ annotator.id }}">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="api-link">
    <a href="{{ url_for('annotator_dump') }}">Download CSV</a>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Comparison Network</h2>
  </div>
  <div class="info">
    <div class="graph-container" id="comparison-graph"></div>
    <div class="graph-tooltip" id="graph-tooltip"></div>
    <p style="margin-top: 1rem; color: #666; font-size: 0.9rem;">
      Node size represents project score (μ). Links show win relationships. Drag nodes to explore.
    </p>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Sync Projects from API</h2>
  </div>
  <div class="info">
    <p>Automatically sync projects from HackPSU API (runs every 5 minutes)</p>
    <form action="{{ url_for('sync_projects') }}" method="post">
      <input type="submit" value="Sync Now" class="button-full positive">
      <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
    </form>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Add Projects Manually</h2>
  </div>
  <div class="info">
    <p>Add name, location, description (CSV format)</p>
    <textarea name="data" form="item_form"></textarea>
    <form action="{{ url_for('item') }}" method="post" id="item_form" enctype="multipart/form-data">
      <div class="upload-container">
        <span class="field">Or upload a file here:</span>
        <input type="file" name="file" accept=".csv,.xls,.xlsx">
      </div>
      <input type="submit" name="action" value="Submit" class="button-full positive">
      <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
    </form>
  </div>
</div>
<div class="item">
  <div class="banner">
    <h2>Add Judges</h2>
  </div>
  <div class="info">
    <p>Add name, email, description (CSV format)</p>
    <textarea name="data" form="annotator_form"></textarea>
    <form action="{{ url_for('annotator') }}" method="post" id="annotator_form" enctype="multipart/form-data">
      <div class="upload-container">
        <span class="field">Or upload a file here:</span>
        <input type="file" name="file" accept=".csv,.xls,.xlsx">
      </div>
      <input type="submit" name="action" value="Submit" class="button-full positive">
      <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
    </form>
  </div>
</div>

<div class="item">
  <div class="banner">
    <h2>Global Settings</h2>
  </div>
  <div class="info">
    <table class="header-row">
      <thead>
        <tr>
          <th>Setting</th>
          <th>Value</th>
          <th>Edit</th>
        </tr>
      </thead>
      <tbody>
        <tr class="{{ 'disabled' if setting_closed else '' }}">
          <td>Closed</td>
          <td>{{ 'Closed' if setting_closed else 'Open' }}</td>
          <td class="compact">
            <form action="{{ url_for('setting') }}" method="post">
              <input type="submit" name="action" value="{{ 'Open' if setting_closed else 'Close' }}" class="{{ 'positive' if setting_closed else 'negative' }}">
              <input type="hidden" name="key" value="closed">
              <input type="hidden" name="_csrf_token" value="{{ csrf_token() }}">
            </form>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
{% block end %}
<script src="{{ url_for('static', filename='js/vendor/tablesort.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/vendor/tablesort.number.js') }}"></script>
<script>
var tables = [
  document.getElementById('items'),
  document.getElementById('annotators'),
];
for (var i = 0; i < tables.length; i++) {
  new Tablesort(tables[i]);
}

// D3.js Force-Directed Graph
(function() {
  const graphData = {{ graph_data | tojson }};
  const container = document.getElementById('comparison-graph');
  const tooltip = document.getElementById('graph-tooltip');

  if (!graphData.nodes.length) {
    container.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">No comparison data available yet.</div>';
    return;
  }

  const width = container.clientWidth;
  const height = container.clientHeight;

  const svg = d3.select('#comparison-graph')
    .append('svg')
    .attr('width', width)
    .attr('height', height);

  // Color scale based on mu score
  const muValues = graphData.nodes.map(d => d.mu);
  const colorScale = d3.scaleSequential(d3.interpolateRdYlGn)
    .domain([Math.min(...muValues), Math.max(...muValues)]);

  // Create force simulation
  const simulation = d3.forceSimulation(graphData.nodes)
    .force('link', d3.forceLink(graphData.links)
      .id(d => d.id)
      .distance(100)
      .strength(0.5))
    .force('charge', d3.forceManyBody().strength(-300))
    .force('center', d3.forceCenter(width / 2, height / 2))
    .force('collision', d3.forceCollide().radius(d => d.size + 5));

  // Create links
  const link = svg.append('g')
    .selectAll('line')
    .data(graphData.links)
    .enter()
    .append('line')
    .attr('class', 'link')
    .attr('stroke-width', d => Math.sqrt(d.weight));

  // Create arrow markers
  svg.append('defs').selectAll('marker')
    .data(['arrow'])
    .enter()
    .append('marker')
    .attr('id', 'arrow')
    .attr('viewBox', '0 -5 10 10')
    .attr('refX', 20)
    .attr('refY', 0)
    .attr('markerWidth', 6)
    .attr('markerHeight', 6)
    .attr('orient', 'auto')
    .append('path')
    .attr('d', 'M0,-5L10,0L0,5')
    .attr('fill', '#999');

  link.attr('marker-end', 'url(#arrow)');

  // Create nodes
  const node = svg.append('g')
    .selectAll('circle')
    .data(graphData.nodes)
    .enter()
    .append('circle')
    .attr('class', 'node')
    .attr('r', d => d.size)
    .attr('fill', d => colorScale(d.mu))
    .call(d3.drag()
      .on('start', dragstarted)
      .on('drag', dragged)
      .on('end', dragended))
    .on('mouseover', function(event, d) {
      d3.select(this)
        .transition()
        .duration(200)
        .attr('r', d.size * 1.3);

      tooltip.style.opacity = 1;
      tooltip.innerHTML = `
        <strong>${d.name}</strong><br/>
        μ: ${d.mu.toFixed(4)}<br/>
        σ²: ${d.sigma_sq.toFixed(4)}
      `;
    })
    .on('mousemove', function(event) {
      tooltip.style.left = (event.pageX + 10) + 'px';
      tooltip.style.top = (event.pageY - 10) + 'px';
    })
    .on('mouseout', function(event, d) {
      d3.select(this)
        .transition()
        .duration(200)
        .attr('r', d.size);

      tooltip.style.opacity = 0;
    });

  // Update positions on simulation tick
  simulation.on('tick', () => {
    link
      .attr('x1', d => d.source.x)
      .attr('y1', d => d.source.y)
      .attr('x2', d => d.target.x)
      .attr('y2', d => d.target.y);

    node
      .attr('cx', d => Math.max(d.size, Math.min(width - d.size, d.x)))
      .attr('cy', d => Math.max(d.size, Math.min(height - d.size, d.y)));
  });

  // Drag functions
  function dragstarted(event, d) {
    if (!event.active) simulation.alphaTarget(0.3).restart();
    d.fx = d.x;
    d.fy = d.y;
  }

  function dragged(event, d) {
    d.fx = event.x;
    d.fy = event.y;
  }

  function dragended(event, d) {
    if (!event.active) simulation.alphaTarget(0);
    d.fx = null;
    d.fy = null;
  }

  // Update link stroke width based on comparison count (weight)
  link.attr('stroke-width', d => Math.sqrt(d.weight) + 1);
})();

// ========================================
// VOTING TIMELINE CHART
// ========================================
(() => {
  const votingData = {{ voting_timeline.hourly_data | tojson }};
  const canvas = document.getElementById('votingTimelineChart');
  if (!canvas) return;

  const ctx = canvas.getContext('2d');
  const width = canvas.parentElement.clientWidth;
  const height = 300;
  canvas.width = width;
  canvas.height = height;

  const padding = {top: 20, right: 20, bottom: 60, left: 50};
  const chartWidth = width - padding.left - padding.right;
  const chartHeight = height - padding.top - padding.bottom;

  const maxCount = Math.max(...votingData.map(d => d.count), 1);
  const barWidth = chartWidth / votingData.length;

  // Draw bars
  votingData.forEach((d, i) => {
    const barHeight = (d.count / maxCount) * chartHeight;
    const x = padding.left + i * barWidth;
    const y = height - padding.bottom - barHeight;

    ctx.fillStyle = '#007bff';
    ctx.fillRect(x, y, barWidth - 2, barHeight);

    // Draw value on top of bar
    if (d.count > 0) {
      ctx.fillStyle = '#333';
      ctx.font = '10px sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText(d.count, x + barWidth/2, y - 5);
    }
  });

  // Draw axes
  ctx.strokeStyle = '#333';
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(padding.left, height - padding.bottom);
  ctx.lineTo(width - padding.right, height - padding.bottom);
  ctx.stroke();

  ctx.beginPath();
  ctx.moveTo(padding.left, padding.top);
  ctx.lineTo(padding.left, height - padding.bottom);
  ctx.stroke();

  // Draw x-axis labels (show all hours for 2-hour window)
  ctx.fillStyle = '#666';
  ctx.font = '11px sans-serif';
  ctx.textAlign = 'center';
  votingData.forEach((d, i) => {
    const x = padding.left + i * barWidth + barWidth/2;
    const hour = new Date(d.time).getHours();
    const minute = new Date(d.time).getMinutes();
    ctx.fillText(hour + ':' + (minute < 10 ? '0' : '') + minute, x, height - padding.bottom + 20);
  });

  // Draw y-axis label
  ctx.save();
  ctx.translate(15, height/2);
  ctx.rotate(-Math.PI/2);
  ctx.textAlign = 'center';
  ctx.fillText('Votes', 0, 0);
  ctx.restore();
})();

// ========================================
// COVERAGE HEATMAP
// ========================================
(() => {
  const matrix = {{ coverage_matrix.matrix | tojson }};
  const projectNames = {{ coverage_matrix.project_names | tojson }};
  const canvas = document.getElementById('coverageHeatmap');
  if (!canvas || matrix.length === 0) return;

  const n = matrix.length;
  const cellSize = Math.max(20, Math.min(40, 800 / n));
  const width = n * cellSize + 200; // Extra space for labels
  const height = n * cellSize + 80;

  canvas.width = width;
  canvas.height = height;
  const ctx = canvas.getContext('2d');

  const maxValue = Math.max(...matrix.flat());

  // Draw heatmap cells
  for (let i = 0; i < n; i++) {
    for (let j = 0; j < n; j++) {
      const value = matrix[i][j];
      const intensity = maxValue > 0 ? value / maxValue : 0;

      // Color gradient from white to blue
      const color = `rgb(${255 - intensity * 200}, ${255 - intensity * 150}, 255)`;

      ctx.fillStyle = color;
      ctx.fillRect(100 + j * cellSize, 20 + i * cellSize, cellSize - 1, cellSize - 1);

      // Draw value if significant
      if (value > 0 && cellSize > 15) {
        ctx.fillStyle = intensity > 0.5 ? '#fff' : '#333';
        ctx.font = `${Math.min(cellSize / 2, 10)}px sans-serif`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(value, 100 + j * cellSize + cellSize/2, 20 + i * cellSize + cellSize/2);
      }
    }
  }

  // Draw row labels (truncated project names)
  ctx.fillStyle = '#333';
  ctx.font = '10px sans-serif';
  ctx.textAlign = 'right';
  ctx.textBaseline = 'middle';
  for (let i = 0; i < Math.min(n, 20); i++) { // Limit to 20 labels
    const name = projectNames[i].length > 12 ? projectNames[i].substring(0, 10) + '...' : projectNames[i];
    ctx.fillText(name, 95, 20 + i * cellSize + cellSize/2);
  }

  // Draw legend
  ctx.fillStyle = '#333';
  ctx.font = 'bold 11px sans-serif';
  ctx.textAlign = 'left';
  ctx.fillText('Comparisons:', 100, height - 10);

  const legendWidth = 100;
  const legendX = 220;
  for (let i = 0; i <= 10; i++) {
    const intensity = i / 10;
    const color = `rgb(${255 - intensity * 200}, ${255 - intensity * 150}, 255)`;
    ctx.fillStyle = color;
    ctx.fillRect(legendX + i * (legendWidth / 10), height - 20, legendWidth / 10, 15);
  }
  ctx.strokeRect(legendX, height - 20, legendWidth, 15);

  ctx.fillStyle = '#333';
  ctx.font = '10px sans-serif';
  ctx.fillText('0', legendX, height - 5);
  ctx.textAlign = 'right';
  ctx.fillText(maxValue, legendX + legendWidth, height - 5);
})();
</script>
{% endblock %}
